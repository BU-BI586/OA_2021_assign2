---
title: "Untitled"
author: "Olivia Nieves"
date: "3/23/2021"
output: html_document
---
Set your working directory
```{r}
setwd("C:/Users/Olivia Nieves/Documents/BU undergrad/BI586/OA_assign2") 
```

Library the necessary packages
```{r}
library(DESeq2) 
library(affycoretools)
library(arrayQualityMetrics)
library(genefilter)
library(Biobase)
library(ggplot2)
library(dplyr)
library(pheatmap)
library(vegan)
library(ggrepel)
library(tidyverse)
```

Look for outliers. First, read in counts then create arrayQualityMetrics report and check HTML export file for outliers. NOTE: no outliers found in our data set.
```{r}
countData <- read.table("1.Assign2_GE_Sym_OA.csv", sep=",", header=T)
head(countData)
row.names(countData)=countData$X
countData$X=NULL
length(countData[,1])
#41850
treat=c( "Control_1", "P2553_1", "P2553_2", "Control_2")
g=data.frame(treat)
g
colData<- g

dds<-DESeqDataSetFromMatrix(countData=countData, colData=g, design=~treat)

vsd.ge=assay(vst(dds))
rl=vst(dds)
e=ExpressionSet(assay(rl), AnnotatedDataFrame(as.data.frame(colData(rl))))
arrayQualityMetrics(e,intgroup=c("treat"),force=T)
```

Re-read in counts and Plot counts.
```{r}
countData <- read.table("1.Assign2_GE_Sym_OA.csv", sep=",", header=T)
head(countData)
row.names(countData)=countData$X
countData$X=NULL
length(countData[,1])

totalCounts=colSums(countData)
totalCounts
barplot(totalCounts, col=c("coral", "blue", "blue", "coral"), ylab="raw counts")
```

DESeq analysis to see how our data varies by treatment. Re-read in counts then perform DESeq function.
```{r}
countData <- read.table("1.Assign2_GE_Sym_OA.csv", sep=",", header=T)
head(countData)
row.names(countData)=countData$X
countData$X=NULL
length(countData[,1])
treat=c( "Control", "P2553", "P2553", "Control")
g=data.frame(treat)
g
colData<- g


dds<-DESeqDataSetFromMatrix(countData=countData, colData=colData, design=~treat) 

dds<-DESeq(dds)
head(dds)
res<- results(dds)
```

Look at dispersions plot
```{r}
plotDispEsts(dds, main="Dispersion plot")
```

